<!-- User

我修改了一些地方，请你在我的代码基础上修改，具体需求我稍后给出: <content of test.ipynb>

请将其使用html 和js 重写，要求有一个单页网页来承载所有功能，网页中有一个按钮来启动生成过程，重复点击可重复生成新的图形，按钮下方还有一个div来显示生成的svg图形。这次我们想生成svg矢量图, 因此没有像素的概念了，但是图形的整体比例仍然是10：6.

然后就是人工修改
 -->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SVG Generator</title>
    <style>
        svg {
            border: 1px solid black;
        }
    </style>
</head>

<body>
    <!-- run & export -->
    <button id="generateButton">Generate Pattern</button>
    <button id="exportButton">Export SVG</button>

    <!-- editor -->
    <p> <label for="userInput">grid width: </label> <input type="text" id="userInput" name="userInput" value=100>
        <label for="userInput">grid height: </label> <input type="text" id="userInput" name="userInput" value=100>
    </p>

    <label for="colorPalette">Choose a color palette:</label>
    <select id="colorPalette" name="colorPalette" onchange="initializeColorPickers(this.value)">
        <option value="palette_blue"> blue </option>
        <option value="palette_green"> green </option>
    </select>

    <div>
        <label for="colorPicker1">Color 1:</label>
        <input type="color" id="colorPicker1" name="colorPicker1">
        <label for="colorPicker2">Color 2:</label>
        <input type="color" id="colorPicker2" name="colorPicker2">
        <label for="colorPicker3">Color 3:</label>
        <input type="color" id="colorPicker3" name="colorPicker3">
        <label for="colorPicker4">Color 4:</label>
        <input type="color" id="colorPicker4" name="colorPicker4">
        <label for="colorPicker5">Color 5:</label>
        <input type="color" id="colorPicker5" name="colorPicker5">
        <label for="colorPicker6">Color 6:</label>
        <input type="color" id="colorPicker6" name="colorPicker6">
    </div>

    <!-- one layer -->
    <p>
        <label>shape preset: </label>
        <select id="dropdown" name="dropdown">
            <option value="shape_circles">圆和四分之一圆</option>
            <option value="shape_lines">线段</option>
            <option value="shape_diagonal">斜角</option>
        </select>
    </p>

    <script src="colorPaletteScript.js">
    </script>

    <div id="svgContainer"></div>

    <script>
        const shapes = ['circle', 'quarter circle', 'blank'];

        // const roatations = ['rotate(0, 50, 50)', 'rotate(90, 50, 50)', 'rotate(180, 50, 50)', 'rotate(270, 50, 50)']
        const roatations = ['rotate(0, 50, 50)', 'rotate(90, 50, 50)', 'rotate(180, 50, 50)', 'rotate(270, 50, 50)']

        function getShape(shapeName, shapeColor) {
            const svgns = "http://www.w3.org/2000/svg";
            let shapeElement;
            switch (shapeName) {
                case 'circle':
                    shapeElement = document.createElementNS(svgns, 'circle');
                    shapeElement.setAttribute('cx', '50');
                    shapeElement.setAttribute('cy', '50');
                    shapeElement.setAttribute('r', '50');
                    shapeElement.setAttribute('fill', shapeColor);
                    break;
                case 'quarter circle':
                    shapeElement = document.createElementNS(svgns, 'path');
                    shapeElement.setAttribute('d', 'M0,0 Q0,100 100,100 L100,0 Z');
                    shapeElement.setAttribute('fill', shapeColor);
                    shapeElement.setAttribute('transform', choice(roatations));
                    break;
                case 'diagonal':
                    shapeElement = document.createElementNS(svgns, 'path');
                    shapeElement.setAttribute('d', 'M0,0 L100,0 L0,100 Z');
                    shapeElement.setAttribute('fill', shapeColor);
                    shapeElement.setAttribute('transform', choice(roatations));
                    break;
            }
            return shapeElement
        }

        function generateSquareSVG(color, shapeColor, shape) {
            const svgns = "http://www.w3.org/2000/svg";
            const svgElement = document.createElementNS(svgns, 'svg');
            svgElement.setAttribute('width', '100');
            svgElement.setAttribute('height', '100');

            const rect = document.createElementNS(svgns, 'rect');
            rect.setAttribute('width', '100');
            rect.setAttribute('height', '100');
            rect.setAttribute('fill', color);
            svgElement.appendChild(rect);

            if (shape !== 'blank') {
                svgShape = getShape(shape, shapeColor)
                svgElement.appendChild(svgShape);
            }

            return svgElement;
        }

        function choice(list) {
            return list[Math.floor(Math.random() * list.length)];
        }


        function collectColorPalette() {
            colorPalette =
                [
                    document.getElementById('colorPicker1').value,
                    document.getElementById('colorPicker2').value,
                    document.getElementById('colorPicker3').value,
                    document.getElementById('colorPicker4').value,
                    document.getElementById('colorPicker5').value,
                    document.getElementById('colorPicker6').value
                ];
            return colorPalette
        }

        // 生成SVG图案并显示在页面上
        function generateAndDisplayPattern() {
            // collect color array from color pickers
            const palette = collectColorPalette()

            const svgContainer = document.getElementById('svgContainer');
            svgContainer.innerHTML = '';

            const svgElement = document.createElementNS("http://www.w3.org/2000/svg", "svg");
            svgElement.setAttribute('width', '1000');
            svgElement.setAttribute('height', '600');

            for (let i = 0; i < 6; i++) {
                for (let j = 0; j < 10; j++) {
                    const color = choice(palette)
                    const shapeColor = choice(palette)
                    const shape = choice(shapes);

                    const svgSquare = generateSquareSVG(color, shapeColor, shape);
                    svgSquare.setAttribute('x', j * 100);
                    svgSquare.setAttribute('y', i * 100);
                    svgElement.appendChild(svgSquare);
                }
            }

            svgContainer.appendChild(svgElement);
        }

        // 添加按钮点击事件处理程序
        document.getElementById('generateButton').addEventListener('click', generateAndDisplayPattern);


        // 添加导出SVG文件的功能
        document.getElementById('exportButton').addEventListener('click', function () {
            const svgElement = document.getElementById('svgContainer').querySelector('svg');
            const svgContent = new XMLSerializer().serializeToString(svgElement);
            const blob = new Blob([svgContent], { type: 'image/svg+xml' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'pattern.svg';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        });

        // 初始生成一次图案
        generateAndDisplayPattern();
    </script>
</body>

</html>